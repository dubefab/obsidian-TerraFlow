/* Anthropic Obsidian Theme - Optimized */

/* CSS Variables */
:root {
  --radius-sm: 5px;
  --radius-md: 8px;
  --radius-lg: 10px;
  --radius-xl: 15px;
  --shadow-xs: 0 1px 3px rgba(0, 0, 0, 0.05);
  --shadow-sm: 0 1px 4px rgba(0, 0, 0, 0.08);
  --shadow-md: 0 2px 8px rgba(0, 0, 0, 0.1), 0 1.5px 4px rgba(0, 0, 0, 0.06);
  --shadow-lg: 0 6px 18px rgba(0, 0, 0, 0.13), 0 2px 8px rgba(0, 0, 0, 0.09);
  --shadow-xl: 0 8px 16px rgba(0, 0, 0, 0.2), 0 12px 40px rgba(0, 0, 0, 0.1);
  --transition-fast: 0.15s ease;
  --transition-standard: 0.18s ease;
  --transition-slow: 0.3s ease;
  --transition-transform: transform var(--transition-standard);
  --transition-opacity: opacity var(--transition-standard);
  --transition-shadow: box-shadow var(--transition-standard);
  --spacing-xs: 4px;
  --spacing-sm: 8px;
  --spacing-md: 12px;
  --spacing-lg: 16px;
  --spacing-xl: 24px;
  --line-height-tight: 1.3;
  --line-height-normal: 1.5;
  --line-height-relaxed: 1.65;
  --font-weight-normal: 400;
  --font-weight-medium: 500;
  --font-weight-semibold: 600;
  --font-weight-bold: 700;
  --h1-color: #d97756;
  --h1-color-rgb: 217, 119, 86;
  --h2-color: #6a97bb;
  --h2-color-rgb: 106, 151, 187;
  --h3-color: #8f8ca6;
  --h3-color-rgb: 143, 140, 166;
  --h4-color: #798d5d;
  --h4-color-rgb: 121, 141, 93;
  --h5-color: #c36686;
  --h5-color-rgb: 195, 102, 134;
  --h6-color: #779088;
  --h6-color-rgb: 119, 144, 136;
  --link-opacity-normal: 0.1;
  --link-opacity-hover: 0.18;
  --link-opacity-unresolved: 0.05;
  --link-opacity-unresolved-hover: 0.12;
  --folder-accent-opacity: 0.08;
  --folder-accent-hover-opacity: 0.15;
  --folder-active-opacity: 0.2;
  --min-touch-target-size: 44px;
}

/* Theme Colors - Light */
.theme-light {
  --text-normal: #3d3929;
  --text-normal-rgb: 61, 57, 41;
  --text-normal-rgb: 61, 57, 41;
  --background-primary: #eeece2;
  --background-primary-rgb: 238, 236, 226;
  --background-secondary: #e6e4da;
  --background-secondary-rgb: 230, 228, 218;
  --background-secondary-alt: #dfdbd1;
  --interactive-normal: #e6e4da;
  --interactive-hover: #dfdbd1;
  --text-muted: #6e6a5a;
  --tab-inactive-color: var(--background-secondary);
  --border-color: #d2cfc5;
  --background-modifier-border: #d2cfc5;
  --divider-color: #d2cfc5;
  --bold-color: #da7756;
  --italic-color: #bd5d3a;
  --text-faint: #8a8677;
  --text-accent: #bd5d3a;
  --interactive-accent: #da7756;
  --interactive-accent-hover: #c56a4c;
  --text-highlight-bg: #f5efe0;
  --text-selection: #f0e0d0;
  --code-background: #e8e6dc;
  --code-text: #3d3929;
  --quote-border: #da7756;
  --quote-background: rgba(238, 236, 226, 0.5);
  --tag-background: #dac0b5;
  --tag-color: #3d3929;
  --tag-background-hover: #d1a998;
  --tag-color-hover: #bd5d3a;
  --tag-border-color: rgba(189, 93, 58, 0.2);
  --checkbox-color: #bd5d3a;
  --table-border: #d2cfc5;
  --table-header-background: #dfdbd1;
  --table-header-text: #3d3929;
  --scrollbar-thumb: #b3b1a7;
  --scrollbar-track: #e6e4da;
  --blockquote-border-color: var(--quote-border);
  --blockquote-background-color: var(--quote-background);
  --link-color: var(--text-accent);
  --link-color-hover: #c56a4c;
  --link-unresolved-color: rgba(189, 93, 58, 0.9);
  --link-unresolved-opacity: 0.8;
  --folder-accent: rgba(var(--h1-color-rgb), var(--folder-accent-opacity));
  --folder-accent-hover: rgba(var(--h1-color-rgb), var(--folder-accent-hover-opacity));
  --folder-active: rgba(var(--h1-color-rgb), var(--folder-active-opacity));
  --properties-background: #e8e6dc;
  --properties-key-color: #bd5d3a;
  --outline-heading-color: #3d3929;
  --outline-border-color: #d2cfc5;
  --outline-active-color: #fff;
  --outline-item-hover-bg: #e6e4da;
  --heading-hover-bg: rgba(217, 119, 86, 0.08);
}

/* Theme Colors - Dark */
.theme-dark {
  --text-normal: #e0ded4;
  --text-normal-rgb: 224, 222, 212;
  --text-normal-rgb: 224, 222, 212;
  --background-primary: #282520;
  --background-primary-rgb: 40, 37, 32;
  --background-secondary: #32302a;
  --background-secondary-rgb: 50, 48, 42;
  --background-secondary-alt: #3a3832;
  --interactive-normal: #32302a;
  --interactive-hover: #3a3832;
  --text-muted: #a5a296;
  --tab-inactive-color: var(--background-secondary);
  --border-color: #4a473e;
  --background-modifier-border: #4a473e;
  --divider-color: #4a473e;
  --bold-color: #f0916f;
  --italic-color: #e27a5a;
  --text-faint: #8a8677;
  --text-accent: #e27a5a;
  --interactive-accent: #f0916f;
  --interactive-accent-hover: #e27a5a;
  --text-highlight-bg: #3a3730;
  --text-selection: #4a4030;
  --code-background: #36342e;
  --code-text: #e0ded4;
  --quote-border: #f0916f;
  --quote-background: rgba(40, 37, 32, 0.5);
  --tag-background: #4a3c35;
  --tag-color: #e0ded4;
  --tag-background-hover: #5a4c45;
  --tag-color-hover: #f0916f;
  --tag-border-color: rgba(240, 145, 111, 0.2);
  --checkbox-color: #e27a5a;
  --table-border: #4a473e;
  --table-header-background: #3a3832;
  --table-header-text: #e0ded4;
  --scrollbar-thumb: #35332e;
  --scrollbar-track: #32302a;
  --blockquote-border-color: var(--quote-border);
  --blockquote-background-color: var(--background-secondary-alt);
  --link-color: var(--text-accent);
  --link-color-hover: #f0916f;
  --link-unresolved-color: rgba(226, 122, 90, 0.4);
  --link-unresolved-opacity: 0.4;
  --folder-accent: rgba(var(--h1-color-rgb), var(--folder-accent-opacity));
  --folder-accent-hover: rgba(var(--h1-color-rgb), var(--folder-accent-hover-opacity));
  --folder-active: rgba(var(--h1-color-rgb), var(--folder-active-opacity));
  --properties-background: #36342e;
  --properties-key-color: #e27a5a;
  --outline-heading-color: #e0ded4;
  --outline-border-color: #4a473e;
  --outline-active-color: #fff;
  --outline-item-hover-bg: #3a3832;
  --heading-hover-bg: rgba(217, 119, 86, 0.15);
}

/* Reset link styling */
.markdown-rendered a,
.markdown-rendered .internal-link,
.markdown-rendered .external-link,
.markdown-source-view.mod-cm6 .cm-link,
.markdown-source-view.mod-cm6 .cm-url,
.markdown-source-view.mod-cm6 .cm-hmd-internal-link,
.markdown-source-view.mod-cm6 .cm-hmd-external-link {
  background: transparent;
  border-radius: 0;
  padding: 0;
  border-bottom: none;
  box-shadow: none;
  text-decoration: none;
  transform: none;
}

.markdown-source-view.mod-cm6 .cm-formatting-link,
.markdown-source-view.mod-cm6 .cm-formatting-link-string,
.markdown-source-view.mod-cm6 .cm-link .cm-underline,
.markdown-source-view.mod-cm6 .cm-url .cm-underline,
.markdown-source-view.mod-cm6 .cm-hmd-internal-link .cm-underline,
.markdown-source-view.mod-cm6 .cm-hmd-external-link .cm-underline {
  background: transparent;
  border-radius: 0;
  padding: 0;
  border-bottom: none;
  box-shadow: none;
  text-decoration: none;
  transform: none;
}

/* Depth effect */
.depth-effect {
  box-shadow: var(--shadow-md);
  transition: var(--transition-transform), var(--transition-shadow);
  will-change: transform, box-shadow;
}

.depth-effect:hover {
  box-shadow: var(--shadow-lg);
  transform: translateY(-1px);
}

.depth-effect:active {
  box-shadow: var(--shadow-sm);
  transform: translateY(1px);
}

/* High contrast text for dark theme */
.theme-dark .high-contrast-text {
  color: #fff;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.18);
}

/* Glass panel effect */
.glass-panel {
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  background-color: rgba(var(--background-primary-rgb, 238, 236, 226), 0.7);
  border: 1px solid rgba(var(--text-normal-rgb, 61, 57, 41), 0.1);
}

.theme-dark .glass-panel {
  background-color: rgba(var(--background-primary-rgb, 40, 37, 32), 0.7);
}

/* Editor fixes */
.markdown-source-view,
.cm-editor,
.markdown-source-view.mod-cm6 .cm-scroller,
.CodeMirror {
  border: none !important;
  border-radius: var(--radius-lg) !important;
  overflow: hidden;
  background-clip: padding-box;
}

.workspace-leaf-content[data-type="markdown"] .view-content,
.workspace-leaf-content[data-type="markdown"] .markdown-source-view {
  border: none !important;
  box-shadow: none !important;
}

/* Common border radius - Group 1 */
.markdown-preview-view h1,
.markdown-preview-view h2,
.markdown-preview-view h3,
.markdown-preview-view h4,
.markdown-preview-view h5,
.markdown-preview-view h6,
button,
.clickable-icon,
.nav-action-button,
.callout,
.cm-callout,
.tag,
a.tag {
  border-radius: var(--radius-lg);
}

/* Common border radius - Group 2 */
input[type="text"],
input[type="search"],
input[type="password"],
input[type="email"],
input[type="number"],
textarea,
.markdown-rendered table,
.markdown-preview-view table,
.modal,
.modal-container,
.prompt,
.menu,
.dropdown {
  border-radius: var(--radius-lg);
}

/* Common border radius - Group 3 */
.search-result-file-title,
.search-result-file-match,
.nav-folder-title,
.nav-file-title,
.vertical-tab-header,
.vertical-tab-nav-item,
.workspace-leaf,
.workspace-split,
.workspace-tabs,
.view-header,
.tag-pane-tag-count,
.tag-container {
  border-radius: var(--radius-lg);
}

/* Common box shadow - Group 1 */
.markdown-preview-view h1,
.markdown-preview-view h2,
.markdown-preview-view h3,
.markdown-preview-view h4,
.markdown-preview-view h5,
.markdown-preview-view h6,
button,
.clickable-icon,
.nav-action-button,
.callout,
.cm-callout,
.tag,
a.tag {
  box-shadow: var(--shadow-md);
  transition: var(--transition-transform), var(--transition-shadow), var(--transition-opacity);
}

/* Common box shadow - Group 2 */
input[type="text"],
input[type="search"],
input[type="password"],
input[type="email"],
input[type="number"],
textarea,
.markdown-rendered table,
.markdown-preview-view table,
.modal,
.modal-container,
.prompt,
.menu,
.dropdown {
  box-shadow: var(--shadow-md);
  transition: var(--transition-transform), var(--transition-shadow), var(--transition-opacity);
}

/* Common box shadow - Group 3 */
.nav-folder-title,
.nav-file-title,
.vertical-tab-header,
.vertical-tab-nav-item,
.workspace-leaf,
.workspace-split,
.workspace-tabs,
.view-header,
.tag-pane-tag-count,
.tag-container {
  box-shadow: var(--shadow-md);
  transition: var(--transition-transform), var(--transition-shadow), var(--transition-opacity);
}

/* Remove box shadow from file explorer items */
.nav-file-title,
.nav-folder-title,
.tree-item-self,
.search-result-file-title,
.search-result-file-match {
  box-shadow: none !important;
}

/* Button hover effects */
button:hover,
.clickable-icon:hover,
.nav-action-button:hover,
.tag:hover,
a.tag:hover {
  box-shadow: var(--shadow-lg);
  filter: brightness(1.05);
  will-change: transform, box-shadow;
}

button:active,
.clickable-icon:active,
.nav-action-button:active,
.tag:active,
a.tag:active {
  box-shadow: var(--shadow-xs);
  filter: brightness(0.98);
}

/* Improved focus states */
button:focus-visible,
.clickable-icon:focus-visible,
.nav-action-button:focus-visible,
.tag:focus-visible,
a.tag:focus-visible,
input:focus-visible,
textarea:focus-visible {
  outline: 2px solid var(--interactive-accent);
  outline-offset: 2px;
  box-shadow: var(--shadow-lg);
}

/* Suggestion items */
.suggestion-item,
.vertical-tab-nav-item {
  box-shadow: none;
  border-radius: 0;
  background: none;
}

.suggestion-item:hover,
.vertical-tab-nav-item:hover {
  box-shadow: var(--shadow-sm);
  border-radius: var(--radius-lg);
  background: var(--interactive-hover);
  z-index: 2;
}

.suggestion-item.is-selected,
.vertical-tab-nav-item.is-active {
  background: var(--background-secondary);
  color: var(--text-normal);
  border-radius: var(--radius-lg);
  border-left: 4px solid var(--interactive-accent);
}

.setting-item.mod-selected,
.vertical-tab-nav-item.is-active {
  background: var(--interactive-hover);
  color: var(--text-normal);
  border-radius: var(--radius-lg);
}

/* Dark theme heading styles */
.theme-dark .markdown-preview-view h1,
.theme-dark .markdown-preview-view h2,
.theme-dark .markdown-preview-view h3,
.theme-dark .markdown-preview-view h4,
.theme-dark .markdown-preview-view h5,
.theme-dark .markdown-preview-view h6,
.theme-dark .callout,
.theme-dark .cm-callout,
.theme-dark .tag,
.theme-dark a.tag,
.theme-dark button,
.theme-dark .clickable-icon,
.theme-dark .nav-action-button {
  color: #fff;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.18);
}

/* Heading styles */
.markdown-preview-view h1,
.markdown-preview-view h2,
.markdown-preview-view h3,
.markdown-preview-view h4,
.markdown-preview-view h5,
.markdown-preview-view h6,
.markdown-source-view .cm-header-1,
.markdown-source-view .cm-header-2,
.markdown-source-view .cm-header-3,
.markdown-source-view .cm-header-4,
.markdown-source-view .cm-header-5,
.markdown-source-view .cm-header-6 {
  color: white;
  padding: var(--spacing-xs) var(--spacing-sm);
  border-radius: var(--radius-lg);
  margin-top: var(--spacing-xl);
  box-shadow: var(--shadow-md);
  border-bottom: 1px solid rgba(255, 255, 255, 0.22);
  border-left: 6px solid var(--h1-color);
  background: var(--h1-color);
  transition: transform 0.2s ease, box-shadow 0.2s ease, background-color 0.2s ease;
  font-weight: var(--font-weight-semibold);
  letter-spacing: -0.01em;
  will-change: transform, box-shadow, background-color;
}

/* Heading colors */
.markdown-preview-view h1,
.markdown-source-view .cm-header-1 {
  background: var(--h1-color);
}

.markdown-preview-view h2,
.markdown-source-view .cm-header-2 {
  border-left: 6px solid var(--h2-color);
  background: var(--h2-color);
}

.markdown-preview-view h3,
.markdown-source-view .cm-header-3 {
  border-left: 6px solid var(--h3-color);
  background: var(--h3-color);
}

.markdown-preview-view h4,
.markdown-source-view .cm-header-4 {
  border-left: 6px solid var(--h4-color);
  background: var(--h4-color);
}

.markdown-preview-view h5,
.markdown-source-view .cm-header-5 {
  border-left: 6px solid var(--h5-color);
  background: var(--h5-color);
}

.markdown-preview-view h6,
.markdown-source-view .cm-header-6 {
  border-left: 6px solid var(--h6-color);
  background: var(--h6-color);
}

/* Heading hover effects */
.markdown-preview-view h1:hover,
.markdown-preview-view h2:hover,
.markdown-preview-view h3:hover,
.markdown-preview-view h4:hover,
.markdown-preview-view h5:hover,
.markdown-preview-view h6:hover {
  transform: scale(1.025) translateY(-2px);
  box-shadow: var(--shadow-lg);
  filter: brightness(1.05);
  z-index: 2;
}

/* Live preview mode heading hover effects */
.markdown-source-view.mod-cm6 .cm-header-1:hover,
.markdown-source-view.mod-cm6 .cm-header-2:hover,
.markdown-source-view.mod-cm6 .cm-header-3:hover,
.markdown-source-view.mod-cm6 .cm-header-4:hover,
.markdown-source-view.mod-cm6 .cm-header-5:hover,
.markdown-source-view.mod-cm6 .cm-header-6:hover {
  filter: brightness(1.05);
  box-shadow: var(--shadow-lg);
  transform: translateY(-1px);
}

/* Line height settings */
.markdown-preview-view .markdown-preview-section,
.markdown-source-view.mod-cm6 .cm-line:not(.cm-active),
.markdown-preview-view p,
.markdown-source-view.mod-cm6 .cm-line {
  line-height: var(--line-height-relaxed) !important;
}

.markdown-preview-view code,
.markdown-source-view .cm-line .cm-inline-code {
  line-height: var(--line-height-normal);
}

.markdown-preview-view h1,
.markdown-preview-view h2,
.markdown-preview-view h3,
.markdown-preview-view h4,
.markdown-preview-view h5,
.markdown-preview-view h6,
.cm-line .cm-header,
.HyperMD-header {
  line-height: var(--line-height-tight);
}

/* Highlight styling - Light theme */
.theme-light .markdown-rendered mark,
.theme-light span.cm-highlight,
.theme-light .markdown-preview-view mark,
.theme-light .cm-s-obsidian span.cm-highlight {
  padding: 5px;
  border-radius: var(--radius-sm);
  background-color: #bcd1ca;
  color: #3d3929;
  border-bottom: 1px solid #a9c0b8;
}

/* Highlight styling - Dark theme */
.theme-dark .markdown-rendered mark,
.theme-dark span.cm-highlight,
.theme-dark .markdown-preview-view mark,
.theme-dark .cm-s-obsidian span.cm-highlight {
  padding: 5px;
  border-radius: var(--radius-sm);
  background-color: #3a524b;
  color: #e0f2e9;
  text-shadow: 0 1px 1px rgba(0, 0, 0, 0.3);
}

/* Strikethrough styling */
.markdown-rendered del,
.cm-strikethrough {
  text-decoration-color: #d97756;
  text-decoration-thickness: 2px;
  opacity: 0.8;
  font-style: italic;
}

.theme-dark .markdown-rendered del,
.theme-dark .cm-strikethrough {
  color: #d07a50;
  text-decoration-color: #d07a50;
}

/* Blockquote styling */
.markdown-preview-view blockquote,
.markdown-rendered blockquote,
div:not(.CodeMirror-activeline) > .HyperMD-quote,
.markdown-source-view.mod-cm6 .cm-line.HyperMD-quote {
  border-radius: var(--radius-lg);
  border: none;
  overflow: hidden;
  padding: var(--spacing-lg);
  margin: 15px 0;
  background-image: linear-gradient(
    to right,
    var(--blockquote-border-color) 4px,
    var(--blockquote-background-color) 4px
  );
  box-shadow: var(--shadow-sm);
  transition: box-shadow var(--transition-slow), transform var(--transition-slow);
  position: relative;
  will-change: transform, box-shadow;
}

/* Blockquote paragraph styling */
.markdown-preview-view blockquote p,
.markdown-rendered blockquote p,
.markdown-source-view.mod-cm6 .cm-line.HyperMD-quote {
  text-indent: 0;
  margin-left: 0;
  padding-left: 0;
}

/* Restore bold and italic styling in blockquotes */
.markdown-preview-view blockquote strong,
.markdown-rendered blockquote strong,
.markdown-source-view.mod-cm6 .cm-line.HyperMD-quote .cm-strong {
  color: var(--bold-color);
  font-weight: var(--font-weight-bold);
}

.markdown-preview-view blockquote em,
.markdown-rendered blockquote em,
.markdown-source-view.mod-cm6 .cm-line.HyperMD-quote .cm-em {
  color: var(--italic-color);
  font-style: italic;
}

.markdown-preview-view blockquote:hover,
.markdown-rendered blockquote:hover,
div:not(.CodeMirror-activeline) > .HyperMD-quote:hover,
.markdown-source-view.mod-cm6 .cm-line.HyperMD-quote:hover {
  box-shadow: var(--shadow-xl);
  transform: translateY(-2px);
  border-radius: var(--radius-lg);
}

/* Image styling */
.markdown-rendered img,
.markdown-source-view.mod-cm6 .cm-content img {
  border-radius: var(--radius-lg);
  transition: transform 0.2s ease, box-shadow 0.2s ease;
  will-change: transform, box-shadow;
  box-shadow: var(--shadow-sm);
}

.markdown-rendered img:hover,
.markdown-source-view.mod-cm6 .cm-content img:hover {
  transform: scale(1.01);
  box-shadow: var(--shadow-md);
  border-radius: var(--radius-lg);
}

/* Callout styling */
.callout,
.cm-callout {
  border-radius: var(--radius-xl);
  border-width: 1px;
  overflow: hidden;
  box-shadow: var(--shadow-md);
  transition: box-shadow var(--transition-slow), transform var(--transition-slow);
  will-change: transform, box-shadow;
}

.callout:hover,
.cm-callout:hover {
  box-shadow: var(--shadow-xl);
  transform: translateY(-2px);
}

.callout {
  border-left-width: 4px;
}

.callout .callout-title {
  padding: var(--spacing-xs) var(--spacing-sm);
  font-weight: var(--font-weight-medium);
  background: transparent;
  border-bottom: none;
}

.callout .callout-content {
  padding: var(--spacing-xs) var(--spacing-sm);
}

/* Table styling */
.markdown-rendered table,
.markdown-preview-view table {
  border-radius: var(--radius-lg);
  overflow: hidden;
  border-collapse: separate;
  border-spacing: 0;
  box-shadow: var(--shadow-md);
}

.markdown-rendered table th,
.markdown-preview-view table th {
  background-color: var(--table-header-background);
  padding: var(--spacing-sm) var(--spacing-md);
  font-weight: var(--font-weight-semibold);
}

.markdown-rendered table td,
.markdown-preview-view table td {
  padding: var(--spacing-sm) var(--spacing-md);
  border-top: 1px solid var(--table-border);
}

/* Table row striping */
.markdown-rendered table tr:nth-child(even),
.markdown-preview-view table tr:nth-child(even) {
  background-color: rgba(0, 0, 0, 0.02);
}

.theme-dark .markdown-rendered table tr:nth-child(even),
.theme-dark .markdown-preview-view table tr:nth-child(even) {
  background-color: rgba(255, 255, 255, 0.02);
}

/* Code block styling */
.markdown-rendered pre,
.markdown-preview-view pre,
.markdown-source-view.mod-cm6 .cm-code-block {
  border-radius: var(--radius-lg);
  overflow: hidden;
  box-shadow: var(--shadow-md);
  border: 1px solid var(--border-color);
}

.markdown-rendered pre code,
.markdown-preview-view pre code {
  padding: var(--spacing-md);
  display: block;
}

.markdown-rendered code:not(pre code),
.markdown-preview-view code:not(pre code),
.cm-inline-code {
  border-radius: var(--radius-sm);
  padding: 2px 4px;
  background-color: var(--code-background);
  color: var(--code-text);
  font-size: 0.9em;
}

/* Input styling */
input[type="text"],
input[type="search"],
input[type="password"],
input[type="email"],
input[type="number"],
textarea {
  background: var(--background-secondary);
  color: var(--text-normal);
  border: 1px solid var(--divider-color);
  border-radius: var(--radius-md);
  box-shadow: none;
  transition: background 0.2s ease, border 0.2s ease;
}

input[type="text"]:focus,
input[type="search"]:focus,
input[type="password"]:focus,
input[type="email"]:focus,
input[type="number"]:focus,
textarea:focus {
  background: var(--background-primary);
  border: 1.5px solid var(--interactive-accent);
  outline: none;
}

/* Scrollbar styling */
::-webkit-scrollbar {
  width: 4px !important;
  height: 4px !important;
  background-color: transparent !important;
}

::-webkit-scrollbar-thumb {
  background-color: rgba(128, 128, 128, 0.2) !important;
  border-radius: 4px !important;
  border: none !important;
}

::-webkit-scrollbar-thumb:hover {
  background-color: rgba(128, 128, 128, 0.4) !important;
}

::-webkit-scrollbar-track {
  background-color: transparent !important;
}

* {
  scrollbar-width: thin !important;
  scrollbar-color: rgba(128, 128, 128, 0.2) transparent !important;
}

/* Scrollable containers */
.markdown-preview-view,
.markdown-source-view,
.nav-files-container,
.cm-scroller {
  overflow: auto !important;
  transform: translateZ(0);
}

/* Animation */
@keyframes fade-in {
  from {
    opacity: 0;
    transform: scale(0.98) translateY(12px);
  }
  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

.modal,
.prompt,
.suggestion-container {
  animation: fade-in 0.22s ease-out;
  will-change: opacity, transform;
}

.modal *,
.prompt *,
.suggestion-container * {
  animation: none !important;
}

/* Link styling - Reading mode */
.markdown-rendered a,
.markdown-rendered .internal-link,
.markdown-rendered .external-link {
  text-decoration: none;
  background: rgba(var(--h1-color-rgb), 0.08);
  border-radius: var(--radius-lg);
  padding: 2px 6px;
  transition: all 0.2s ease;
  color: var(--link-color);
  border-bottom: 1px solid transparent;
}

.markdown-rendered a:hover,
.markdown-rendered .internal-link:hover,
.markdown-rendered .external-link:hover {
  background: rgba(var(--h1-color-rgb), 0.05);
  color: var(--link-color-hover);
  border-bottom: 1px solid var(--link-color);
  box-shadow: 0 1px 3px rgba(var(--h1-color-rgb), 0.2);
}

/* Standard URL links in markdown format */
.markdown-source-view.mod-cm6 .cm-formatting-link,
.markdown-source-view.mod-cm6 .cm-formatting-link-string,
.markdown-source-view.mod-cm6 .cm-string.cm-url {
  opacity: 0.7;
}

/* Live preview mode links */
.markdown-source-view.mod-cm6 .cm-link:not(.cm-formatting),
.markdown-source-view.mod-cm6 .cm-url:not(.cm-formatting),
.markdown-source-view.mod-cm6 .cm-hmd-internal-link:not(.cm-formatting),
.markdown-source-view.mod-cm6 .cm-hmd-external-link:not(.cm-formatting) {
  background: rgba(var(--h1-color-rgb), 0.08);
  border-radius: var(--radius-lg);
  padding: 2px 6px;
  color: var(--link-color);
  transition: all 0.2s ease;
  border-bottom: 1px solid transparent;
}

.markdown-source-view.mod-cm6 .cm-link:not(.cm-formatting):hover,
.markdown-source-view.mod-cm6 .cm-url:not(.cm-formatting):hover,
.markdown-source-view.mod-cm6 .cm-hmd-internal-link:not(.cm-formatting):hover,
.markdown-source-view.mod-cm6 .cm-hmd-external-link:not(.cm-formatting):hover {
  background: rgba(var(--h1-color-rgb), 0.05);
  color: var(--link-color-hover);
  border-bottom: 1px solid var(--link-color);
  box-shadow: 0 1px 3px rgba(var(--h1-color-rgb), 0.2);
}

@media (hover: hover) {
  .markdown-source-view.mod-cm6 .cm-link .cm-underline:hover, /* <--- ADDED THIS SELECTOR */
  .markdown-source-view.mod-cm6 .cm-url .cm-underline:hover,
  .markdown-source-view.mod-cm6 .cm-hmd-external-link .cm-underline:hover {
    color: var(--link-color-hover) !important;    text-decoration: none !important;
  }
}

/* Unresolved links */
.markdown-rendered .internal-link.is-unresolved,
.markdown-source-view.mod-cm6 .cm-hmd-internal-link.is-unresolved {
  opacity: 0.75;
  background: rgba(var(--h1-color-rgb), 0.08);
  color: var(--link-unresolved-color);
  border-bottom: 1px dashed rgba(var(--h1-color-rgb), 0.3);
}

.markdown-rendered .internal-link.is-unresolved:hover,
.markdown-source-view.mod-cm6 .cm-hmd-internal-link.is-unresolved:hover {
  opacity: 0.9 !important;
  background: rgba(var(--h1-color-rgb), 0.1) !important;
  color: var(--link-unresolved-color) !important;
  border-bottom: 1px dashed var(--link-unresolved-color) !important;
  box-shadow: 0 1px 3px rgba(var(--h1-color-rgb), 0.2) !important;
}

/* Checkbox styling */
input[type="checkbox"] {
  appearance: none;
  -webkit-appearance: none;
  border: 2px solid var(--checkbox-color);
  border-radius: 4px;
  width: 27px;
  height: 27px;
  margin: 0 8px 0 0;
  position: relative;
  vertical-align: middle;
  cursor: pointer;
  transition: all 0.2s ease;
  background-color: transparent;
}

input[type="checkbox"]:checked {
  background-color: var(--checkbox-color);
  border-color: var(--checkbox-color);
  box-shadow: 0 0 8px rgba(var(--h1-color-rgb), 0.4);
}

input[type="checkbox"]:checked::after {
  content: "";
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  width: 18px;
  height: 18px;
  background-color: white;
  mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>');
  -webkit-mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>');
  mask-size: contain;
  -webkit-mask-size: contain;
  mask-repeat: no-repeat;
  -webkit-mask-repeat: no-repeat;
}

input[type="checkbox"]:hover {
  border-color: var(--interactive-accent);
  transform: scale(1.05);
}

/* Task list in live preview mode */
.markdown-source-view.mod-cm6 .task-list-item-checkbox {
  appearance: none;
  -webkit-appearance: none;
  border: 2px solid var(--checkbox-color);
  border-radius: 4px;
  width: 22px;
  height: 22px;
  margin: 0 8px 0 0;
  position: relative;
  vertical-align: middle;
  cursor: pointer;
  transition: all 0.2s ease;
  background-color: transparent;
}

.markdown-source-view.mod-cm6 .task-list-item-checkbox:checked {
  background-color: var(--checkbox-color);
  border-color: var(--checkbox-color);
  box-shadow: 0 0 6px rgba(var(--h1-color-rgb), 0.3);
}

.markdown-source-view.mod-cm6 .task-list-item-checkbox:checked::after {
  content: "";
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  width: 14px;
  height: 14px;
  background-color: white;
  mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>');
  -webkit-mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>');
  mask-size: contain;
  -webkit-mask-size: contain;
  mask-repeat: no-repeat;
  -webkit-mask-repeat: no-repeat;
}

.markdown-source-view.mod-cm6 .task-list-item-checkbox:hover {
  border-color: var(--interactive-accent);
  transform: scale(1.05);
}

/* Tag styling */
.tag,
a.tag {
  display: inline-flex;
  align-items: center;
  background: var(--tag-background);
  border-radius: var(--radius-lg);
  padding: 2px 8px;
  color: var(--tag-color);
  font-size: 0.9em;
  text-decoration: none;
  box-shadow: var(--shadow-xs);
  transition: all var(--transition-standard);
  border: 1px solid var(--tag-border-color);
  font-weight: var(--font-weight-medium);
}

.tag:hover,
a.tag:hover {
  background: var(--tag-background-hover);
  color: var(--tag-color-hover);
  box-shadow: var(--shadow-sm);
  transform: translateY(-1px);
}

/* Hashtag styling in live preview */
.cm-hashtag {
  position: relative;
  display: inline-flex !important;
  align-items: center;
  background: var(--tag-background) !important;
  border-radius: var(--radius-lg) !important;
  padding: 2px 8px !important;
  color: var(--tag-color) !important;
  font-size: 0.9em;
  text-decoration: none !important;
  box-shadow: var(--shadow-xs);
  transition: all var(--transition-standard);
  border: 1px solid var(--tag-border-color) !important;
  font-weight: var(--font-weight-medium);
  margin: 0 2px;
}

.cm-hashtag:hover {
  background: var(--tag-background-hover) !important;
  color: var(--tag-color-hover) !important;
  box-shadow: var(--shadow-sm);
  transform: translateY(-1px);
}

.cm-hashtag-begin,
.cm-hashtag-end {
  display: inline !important;
  background: transparent !important;
  border-radius: 0 !important;
  padding: 0 !important;
  box-shadow: none !important;
  border: none !important;
  margin: 0 !important;
}

.cm-hashtag-begin {
  margin-right: 0 !important;
  border-right: none !important;
}

.cm-hashtag-end {
  margin-left: 0 !important;
  border-left: none !important;
}

.cm-hashtag-begin:hover,
.cm-hashtag-end:hover {
  background: transparent !important;
  box-shadow: none !important;
  transform: none !important;
}

/* Properties styling */
.metadata-container {
  background-color: var(--properties-background);
  border-radius: var(--radius-lg);
  padding: var(--spacing-md);
  margin-bottom: var(--spacing-md);
  box-shadow: var(--shadow-md);
  border: 1px solid var(--border-color);
  transition: box-shadow var(--transition-standard), transform var(--transition-standard);
}

.metadata-container:hover {
  box-shadow: var(--shadow-lg);
  transform: translateY(-2px);
}

.metadata-container .metadata-properties-heading {
  font-weight: var(--font-weight-semibold);
  color: var(--text-normal);
  margin-bottom: var(--spacing-sm);
  padding-bottom: var(--spacing-xs);
  border-bottom: 1px solid var(--divider-color);
}

.metadata-container .metadata-property {
  margin: var(--spacing-xs) 0;
  display: flex;
  align-items: baseline;
}

.metadata-container .metadata-property-key {
  color: var(--properties-key-color);
  font-weight: var(--font-weight-medium);
  margin-right: var(--spacing-sm);
  flex-shrink: 0;
}

.metadata-container .metadata-property-value {
  color: var(--text-normal);
}

/* File tab depth effect */
.workspace-tab-header {
  border-radius: var(--radius-lg) var(--radius-lg) 0 0;
  background: var(--background-secondary-alt);
  color: var(--text-normal);
  padding: 8px 18px 8px 16px;
  margin-right: 4px;
  margin-bottom: 0;
  box-shadow: var(--shadow-sm);
  border-left: 4px solid transparent;
  transition: transform 0.2s ease, box-shadow 0.2s ease, background-color 0.2s ease;
  font-weight: var(--font-weight-medium);
  position: relative;
  z-index: 1;
  will-change: transform, box-shadow;
}

.workspace-tab-header:hover {
  background: var(--background-secondary-alt);
  color: var(--text-normal);
  box-shadow: var(--shadow-md);
  transform: translateY(-2px);
}

.workspace-tab-header.is-active {
  background: var(--background-primary);
  color: var(--text-normal);
  box-shadow: 0 -1px 3px rgba(0, 0, 0, 0.1);
  border-radius: var(--radius-lg) var(--radius-lg) 0 0;
  border-left: none;
  border-right: none;
  z-index: 2;
}

.workspace-tab-header.is-active:hover {
  transform: scale(1.04);
  box-shadow: var(--shadow-lg);
}

.theme-dark .workspace-tab-header {
  background: var(--background-secondary-alt);
  color: var(--text-normal);
}

.theme-dark .workspace-tab-header:hover {
  background: var(--background-secondary);
  color: var(--text-muted);
}

.theme-dark .workspace-tab-header.is-active {
  background: var(--background-primary);
  color: var(--text-normal);
  box-shadow: 0 -1px 3px rgba(0, 0, 0, 0.2);
  border-radius: var(--radius-lg) var(--radius-lg) 0 0;
  border-left: none;
  border-right: none;
  z-index: 2;
}

/* Reduced motion preference */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }

  .markdown-preview-view h1:hover,
  .markdown-preview-view h2:hover,
  .markdown-preview-view h3:hover,
  .markdown-preview-view h4:hover,
  .markdown-preview-view h5:hover,
  .markdown-preview-view h6:hover,
  button:hover,
  .clickable-icon:hover,
  .nav-action-button:hover,
  .markdown-rendered img:hover,
  .callout:hover,
  .markdown-rendered blockquote:hover {
    transform: none !important;
    box-shadow: var(--shadow-md) !important;
  }
}

/* Mobile optimizations */
@media (max-width: 768px) {
  .nav-file-title,
  .nav-folder-title,
  button,
  .clickable-icon,
  .workspace-tab-header,
  .workspace-leaf-resize-handle,
  .tree-item-self {
    min-height: calc(var(--min-touch-target-size) * 0.65);
    min-width: calc(var(--min-touch-target-size) * 0.65);
    padding: 4px 6px;
    font-size: 0.9em;
  }

  input[type="checkbox"],
  .markdown-source-view.mod-cm6 .task-list-item-checkbox {
    width: 22px;
    height: 22px;
  }

  body {
    font-size: 16px;
  }

  .workspace-split.mod-left-split,
  .workspace-split.mod-right-split {
    margin: 0;
    border-radius: 0;
  }
}

/* iOS specific fixes */
@supports (-webkit-touch-callout: none) {
  .workspace-leaf-content,
  .nav-files-container,
  .markdown-preview-view,
  .markdown-source-view {
    -webkit-overflow-scrolling: touch;
  }

  input[type="text"],
  input[type="search"],
  input[type="password"],
  input[type="email"],
  input[type="number"],
  textarea {
    -webkit-appearance: none;
    border-radius: var(--radius-md);
  }

  * {
    -webkit-tap-highlight-color: transparent;
  }
}

/* Print styles */
@media print {
  .workspace-split.mod-left-split,
  .workspace-split.mod-right-split,
  .titlebar,
  .view-header {
    display: none !important;
  }

  .workspace-split.mod-root {
    display: block !important;
  }

  .markdown-preview-view {
    color: black !important;
    background: white !important;
  }

  .markdown-preview-view h1,
  .markdown-preview-view h2,
  .markdown-preview-view h3,
  .markdown-preview-view h4,
  .markdown-preview-view h5,
  .markdown-preview-view h6 {
    color: black !important;
    background: white !important;
    border-left: 3px solid #ddd !important;
    box-shadow: none !important;
  }

  .callout {
    border: 1px solid #ddd !important;
    box-shadow: none !important;
  }
}

/* --- Status Bar Hover --- */

/* Base styles */
.status-bar {
  position: fixed;
  left: 50%;
  transform: translateX(-50%);
  width: fit-content;
  max-width: 90%;
  height: auto;
  min-height: 28px;
  padding: var(--spacing-xs) var(--spacing-md);
  overflow: hidden;
  border-radius: var(--radius-xl);
  background-color: var(--background-secondary);
  border: 1px solid var(--divider-color);
  box-shadow: var(--shadow-sm);
  color: var(--text-muted);
  cursor: default;
  z-index: var(--layer-status-bar);
  
  /* Enable text wrapping for responsive behavior */
  text-wrap: balance;
  white-space: normal;
  word-wrap: break-word;
  
  /* Center content */
  display: flex;
  align-items: center;
  justify-content: center;
  flex-wrap: wrap;
  
  /* Animation properties */
  bottom: 2px;
  transition: transform 250ms cubic-bezier(0.2, 0.9, 0.3, 1.0);
  transform: translateX(-50%) translateY(0);
}

/* Initial COLLAPSED state - slides down when not hovered */
.status-bar:not(:hover) {
  transform: translateX(-50%) translateY(calc(100% - 6px));
  height: 6px;
  min-height: 0;
  padding: 0 10px;
  border-radius: var(--radius-xl);
  background-color: rgba(var(--text-normal-rgb), 0.15);
  border: none;
  box-shadow: none;
  color: transparent;
  max-width: 60px;
  
  /* Slightly different timing for collapse animation */
  transition: transform 200ms cubic-bezier(0.4, 0.0, 0.2, 1.0),
              height 200ms ease,
              min-height 200ms ease,
              max-width 200ms ease,
              padding 200ms ease,
              background-color 200ms ease,
              border 200ms ease,
              box-shadow 200ms ease;
}

/* Status Bar Items - Initially Hidden */
.status-bar > .status-bar-item {
  opacity: 0;
  transition: opacity 200ms ease-out;
  white-space: normal;
  pointer-events: none;
  color: inherit;
  
  /* Center items vertically */
  display: flex;
  align-items: center;
  
  /* Add margin for spacing between wrapped items */
  margin: 2px 4px;
}

/* Status Bar Items - Revealed on Hover */
.status-bar:hover > .status-bar-item {
  opacity: 1;
  pointer-events: auto;
  transition-delay: 50ms;
}

/* Status Bar - Clickable Item Hover */
.status-bar:hover .status-bar-item .clickable-icon:hover,
.status-bar:hover .status-bar-item button:hover {
  background-color: rgba(var(--text-normal-rgb), 0.1);
  border-radius: var(--radius-sm);
  color: var(--text-normal);
}

/* --- Ensure Positioning Context for Status Bar --- */
.app-container .horizontal-main-container {
    position: relative;
}

/* --- Media query for extremely small windows --- */
@media screen and (max-width: 400px) {
  .status-bar:hover {
    max-width: 95%;
    padding: var(--spacing-xs) var(--spacing-xs);
  }
  
  .status-bar > .status-bar-item {
    font-size: 0.9em;
  }
}
